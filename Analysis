Columns for Bright Coffee Analysis transaction_id	transaction_date	transaction_time	transaction_qty	store_id	store_location	product_id	unit_price	product_category	product_type	product_detail		

to show us name of different stores/locations
select distinct store location, store_id
from shopanalysis;

to calculate the number of coffee shops
select count(distict store_id) AS number_of_shops
from shopanalysis;

calculate revenue by store location
select store_location,
     SUM(unit_price*transanction_qty) as revenue
from shopanalysis
GROUP BY store_location;

what time does the store open
select min(transaction_time)  AS opening_time
from shopanalysis;

first date of transactions per store
select min(transaction_date) AS first_day, store_location
from shopanalysis
grou by store location

what time does the store close
select max(transaction_time) AS closing_time
from shopanalysis;

to calculate revenue per product category at different times of the day

select product_category,
       SUM(transaction_qty*unit_price) AS revenue,
       store_location,
       transaction_date,
       transaction_time,
CASE
    When transaction_time between '06:00:00' AND '11:59:59' THEN 'Morning'
    When transaction_time between '12:00:00' AND '15:59:59' THEN 'Afternoon'
    When transaction_time between '16:00:00' AND '19:59:59' THEN 'Evening'
    When transaction_time>='20:00:00' THEN 'Night'
END AS time_bucket
FROM shopanalysis
WHERE transaction_date>'2023-05-01'
GROUP BY product_category, store_location, transaction_date, transaction_time
ORDER BY revenue DESC;








